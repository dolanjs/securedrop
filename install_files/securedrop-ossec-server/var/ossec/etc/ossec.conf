<ossec_config>
  <global>
    <email_notification>yes</email_notification>
    <email_to>root@localhost</email_to>
    <smtp_server>localhost</smtp_server>
    <email_from>ossec@freedom.press</email_from>
  </global>

  <syscheck>
    <!--
      Alert new files
      Only happens during the non-realtime sysscan
      Like after the daily reboots. Does not occur during the real
      time integrity checks.
      They have a event level 0 currently.
    -->
    <alert_new_files>yes</alert_new_files>

    <!--
      Directories to check
      You will want to use the contents of the apparmor profiles
      for each networked process on the system and monitor the
      directories that they have access to.

      Will need to use a combination of `report_changes="no" and
      the <ignore> statement to prevent information disclosure of
      file and directory names to the content of files.

      Files and directories that change often will need the respective
      <ignore> statement to avoid excessive spam.

      Can also use output of netstat and lsof to verify coverage.
      https://ossec-docs.readthedocs.org/en/latest/manual/syscheck/
    -->
    <!-- Generic directories to monitor -->
    <directories realtime="yes" check_all="yes" report_changes="yes">/bin,/sbin</directories>
    <directories realtime="yes" check_all="yes" report_changes="yes">/etc,/usr/bin,/usr/sbin</directories>
    <ignore>/etc/motd</ignore>
    <ignore>/etc/apparmor.d/cache/.features</ignore>
    <ignore>/etc/blkid.tab</ignore>
    <!-- Default files/directories to ignore -->
    <ignore>/etc/mtab</ignore>
    <ignore>/etc/mnttab</ignore>
    <ignore>/etc/hosts.deny</ignore>
    <ignore>/etc/mail/statistics</ignore>
    <ignore>/etc/random-seed</ignore>
    <ignore>/etc/adjtime</ignore>
    <ignore>/etc/httpd/logs</ignore>
    <ignore>/etc/utmpx</ignore>
    <ignore>/etc/wtmpx</ignore>
    <ignore>/etc/cups/certs</ignore>
    <ignore>/etc/dumpdates</ignore>
    <ignore>/etc/svc/volatile</ignore>

    <directories realtime="yes" check_all="yes" report_changes="yes">/var/ossec</directories>
    <ignore>/var/ossec/queue</ignore>
    <ignore>/var/ossec/logs</ignore>
    <ignore>/var/ossec/stats</ignore>
    <ignore>/var/ossec/var</ignore>
    <ignore>/var/ossec/etc/shared/merged.mg</ignore>
    <ignore>/var/ossec/.gnupg/random_seed</ignore>

    <directories realtime="yes" check_all="yes" report_changes="no">/var/lib/tor</directories>
    <ignore>/var/lib/tor/cached-certs</ignore>
    <ignore>/var/lib/tor/cached-microdesc-consensus</ignore>
    <ignore>/var/lib/tor/cached-microdescs</ignore>
    <ignore>/var/lib/tor/cached-microdescs.new</ignore>
    <ignore>/var/lib/tor/lock</ignore>
    <ignore>/var/lib/tor/state</ignore>
  </syscheck>

  <rootcheck>
    <rootkit_files>/var/ossec/etc/shared/rootkit_files.txt</rootkit_files>
    <rootkit_trojans>/var/ossec/etc/shared/rootkit_trojans.txt</rootkit_trojans>
    <system_audit>/var/ossec/etc/shared/system_audit_rcl.txt</system_audit>
    <system_audit>/var/ossec/etc/shared/cis_debian_linux_rcl.txt</system_audit>
  </rootcheck>

  <active-response>
    <disabled>yes</disabled>
  </active-response>

  <remote>
    <connection>secure</connection>
  </remote>

  <alerts>
    <log_alert_level>1</log_alert_level>
    <email_alert_level>7</email_alert_level>
  </alerts>

  <!-- Log files to monitor -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/auth.log</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/syslog</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/kern.log</location>
  </localfile>

  <!-- Unattended security update logs -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/dpkg.log</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/cron-apt/log</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/apt/history.log</location>
  </localfile>

  <!-- Tor logs -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/tor/log</location>
  </localfile>

  <!-- OSSEC email alerts -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/mail.log</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/procmail.log</location>
  </localfile>


  <!-- Command output to monitor -->
  <localfile>
    <log_format>command</log_format>
    <command>df -h</command>
  </localfile>

  <localfile>
    <log_format>full_command</log_format>
    <command>netstat -tan |grep LISTEN |grep -v 127.0.0.1 | sort</command>
  </localfile>

  <localfile>
    <log_format>full_command</log_format>
    <command>last -n 5</command>
  </localfile>

  <reports>
    <group>authentication_success</group>
    <user type="relation">srcip</user>
    <title>Daily report: Successful logins</title>
    <email_to>root@localhost</email_to>
  </reports>

  <reports>
    <group>authentication_failed</group>
    <user type="relation">srcip</user>
    <title>Daily report: Failed login attempts</title>
    <email_to>root@localhost</email_to>
  </reports>

  <reports>
    <group>syscheck</group>
    <title>Daily report: File Changes</title>
    <email_to>root@localhost</email_to>
  </reports>

  <email_alerts>
    <email_to>root@localhost</email_to>
    <group>authentication_success</group>
    <do_not_delay />
    <do_not_group />
  </email_alerts>

  <email_alerts>
    <email_to>root@localhost</email_to>
    <group>authentication_failed</group>
    <do_not_delay />
    <do_not_group />
  </email_alerts>

  <email_alerts>
    <email_to>root@localhost</email_to>
    <group>syscheck</group>
    <do_not_delay />
  </email_alerts>

  <email_alerts>
    <email_to>root@localhost</email_to>
    <group>low_diskspace</group>
    <do_not_delay />
  </email_alerts>

  <!-- rules global entry -->
  <rules>
    <include>rules_config.xml</include>
    <include>pam_rules.xml</include>
    <include>sshd_rules.xml</include>
    <include>telnetd_rules.xml</include>
    <include>syslog_rules.xml</include>
    <include>arpwatch_rules.xml</include>
    <include>symantec-av_rules.xml</include>
    <include>symantec-ws_rules.xml</include>
    <include>pix_rules.xml</include>
    <include>named_rules.xml</include>
    <include>smbd_rules.xml</include>
    <include>vsftpd_rules.xml</include>
    <include>pure-ftpd_rules.xml</include>
    <include>proftpd_rules.xml</include>
    <include>ms_ftpd_rules.xml</include>
    <include>ftpd_rules.xml</include>
    <include>hordeimp_rules.xml</include>
    <include>roundcube_rules.xml</include>
    <include>wordpress_rules.xml</include>
    <include>cimserver_rules.xml</include>
    <include>vpopmail_rules.xml</include>
    <include>vmpop3d_rules.xml</include>
    <include>courier_rules.xml</include>
    <include>web_rules.xml</include>
    <include>web_appsec_rules.xml</include>
    <include>apache_rules.xml</include>
    <include>nginx_rules.xml</include>
    <include>php_rules.xml</include>
    <include>mysql_rules.xml</include>
    <include>postgresql_rules.xml</include>
    <include>ids_rules.xml</include>
    <include>squid_rules.xml</include>
    <include>firewall_rules.xml</include>
    <include>cisco-ios_rules.xml</include>
    <include>netscreenfw_rules.xml</include>
    <include>sonicwall_rules.xml</include>
    <include>postfix_rules.xml</include>
    <include>sendmail_rules.xml</include>
    <include>imapd_rules.xml</include>
    <include>mailscanner_rules.xml</include>
    <include>dovecot_rules.xml</include>
    <include>ms-exchange_rules.xml</include>
    <include>racoon_rules.xml</include>
    <include>vpn_concentrator_rules.xml</include>
    <include>spamd_rules.xml</include>
    <include>msauth_rules.xml</include>
    <include>mcafee_av_rules.xml</include>
    <include>trend-osce_rules.xml</include>
    <include>ms-se_rules.xml</include>
    <!-- <include>policy_rules.xml</include> -->
    <include>zeus_rules.xml</include>
    <include>solaris_bsm_rules.xml</include>
    <include>vmware_rules.xml</include>
    <include>ms_dhcp_rules.xml</include>
    <include>asterisk_rules.xml</include>
    <include>ossec_rules.xml</include>
    <include>attack_rules.xml</include>
    <include>openbsd_rules.xml</include>
    <include>clam_av_rules.xml</include>
    <include>dropbear_rules.xml</include>
    <include>local_rules.xml</include>
  </rules>
</ossec_config>
